apiVersion: v1
kind: Template
metadata:
  creationTimestamp: null
  name: artifactory-operator
labels:
  template: artifactory-operator-template
objects:
- apiVersion: v1
  kind: ImageStream
  metadata:
    creationTimestamp: null
    name: artifactory-operator
  spec:
    lookupPolicy:
      local: false
- apiVersion: v1
  kind: DeploymentConfig
  metadata:
    creationTimestamp: null
    name: artifactory-operator
  spec:
    replicas: 1
    selector:
      deploymentconfig: artifactory-operator
    strategy:
      resources:
        requests:
          cpu: '100m'
        limits:
          cpu: '150m'
    template:
      metadata:
        creationTimestamp: null
        labels:
          deploymentconfig: artifactory-operator
      spec:
        serviceAccountName: artifactory-operator
        containers:
          - name: ansible
            command:
            - /usr/local/bin/ao-logs
            - /tmp/ansible-operator/runner
            - stdout
            image: "docker-registry.default.svc:5000/devops-artifactory/artifactory-operator:v3.2-stable"
            imagePullPolicy: "Always"
            volumeMounts:
            - mountPath: /tmp/ansible-operator/runner
              name: runner
              readOnly: true
          - name: operator
            image: "docker-registry.default.svc:5000/devops-artifactory/artifactory-operator:v3.2-stable"
            imagePullPolicy: "Always"
            volumeMounts:
            - mountPath: /tmp/ansible-operator/runner
              name: runner
            - mountPath: /tmp/ansible-operator/
              name: artifactory-secret
              readOnly: true
            env:
              - name: WATCH_NAMESPACE
              - name: POD_NAME
                valueFrom:
                  fieldRef:
                    fieldPath: metadata.name
              - name: OPERATOR_NAME
                value: "artifactory-operator"
        volumes:
          - name: runner
            emptyDir: {}
          - name: artifactory-secret
            secret:
              secretName: artifactory-admin
    test: false
    triggers:
    - type: ConfigChange
    - imageChangeParams:
        automatic: true
        containerNames:
        - ansible
        - operator
        from:
          kind: ImageStreamTag
          name: artifactory-operator:v3.2-stable
      type: ImageChange

